{% extends "data_base.html" %}

{% block title %}Skin selected{% endblock %}

{% block content %}
<h1 class="text-center">Selected diseases</h1>

<!-- Section 1 -->
<div class="mb-4">
    Any Phecode or ICD10 descriptions that contains the word "Hidradenitis" will be displayed here.
    <br>
    <form >
        <ul id="results-list1" class="results"></ul>
    </form>
</div>

{% endblock %}

{% block extra_js %}
{{ super() }}
<script>
    $(document).ready(function () {
        // run searchData1 function when the page is loaded
        searchData1();
    });

    // function to fetch data from the server to populate the results list
    async function searchData1() {
        const query1 = 'Hidradenitis';
        const resultsList = document.getElementById('results-list1');

        const response = await fetch(`/diseasesearch?query=${query1}`);

        // json resultsData is returned from the server
        const data = await response.json();

        resultsList.innerHTML = '';
        if (data.length === 0) {
            const noResultItem = document.createElement('li');
            noResultItem.className = 'result-item';
            noResultItem.textContent = 'No results found.';
            resultsList.appendChild(noResultItem);
        } else {
            data.forEach(item => {
                const listItem = document.createElement('li');
                listItem.className = 'result-item';

                // Render the search results with a clickable phecode link
                // Oneliner:<p>Phecode: <a href="/plot/${item.phecode}" target="_blank">${item.phecode}</a> | Sex: ${item.sex} | Affected: ${item.affected} | Excluded: ${item.excluded} (${item.phecode_exclude}) | Disease: ${item.phecode_group} </p>
                listItem.innerHTML = `
                        <h4>${item.description}</h4>
                        
                        <p class="p-2 bg-light rounded">
                            <span><a href="/phecode/${item.phecode}" target="_blank">Phecode: ${item.phecode}</a></span> |
                            <span>Sex: ${item.sex}</span> |
                            <span>Affected: <strong>${item.affected}</strong></span> |
                            <span>Excluded: ${item.excluded} (${item.phecode_exclude})</span> |
                            <span>Disease: ${item.phecode_group}</span>
                        <ul class="meaning-list">
                            ${item.meaning.map(meaning => `<li>${meaning}</li>`).join('')}
                        </ul>
                        </p>
                        
                    `;
                resultsList.appendChild(listItem);
            });
        }
    }
</script>
{% endblock %}